# 随机行走位移分布实验报告

姓名：

## 实验目的
- 理解二维随机行走的统计特性
- 掌握数据分析和可视化方法
- 学习概率分布的拟合和验证

## 实验原理
### 随机行走模型
随机行走是一种数学模型，描述粒子在空间中随机移动的过程。在二维模型中，粒子每一步在 x 和 y 方向上独立选择 ±1 的步长，步长方向随机且无记忆性。经过 N 步后，粒子的位移是各步的累加。该模型可用于模拟扩散现象、布朗运动等物理过程。
### 理论预期
位移分布：当步数 N 较大时，x 和 y 方向的位移服从正态分布 \(X, Y \sim \mathcal{N}(0, N)\)，位移模长 \(R = \sqrt{X^2 + Y^2}\) 服从瑞利分布，概率密度函数为：\(f_R(r) = \frac{r}{\sigma^2} e^{-r^2/(2\sigma^2)}, \quad \sigma^2 = N\)
位移平方分布：\(R^2 = X^2 + Y^2\) 服从自由度为 2 的卡方分布（\(\chi^2_2\)），概率密度函数为：\(f_{R^2}(s) = \frac{1}{2} e^{-s/2}, \quad s \geq 0\)
## 实验方法
### 程序实现
1. 随机行走的实现方法
使用 np.random.choice([-1, 1], size=(2, num_simulations, num_steps)) 生成二维随机步长矩阵。
对步数轴求和得到最终位移坐标 (x, y)。
2. 数据收集和处理方法
计算位移模长 \(R = \sqrt{x^2 + y^2}\) 和位移平方 \(R^2 = x^2 + y^2\)。
对 1000 次模拟结果取平均，计算统计量。
3. 可视化方法
使用 plt.hist 绘制直方图，叠加理论分布曲线。
通过线性、半对数、对数坐标观察分布特性。
### 数据分析
1. 位移分布分析方法
拟合瑞利分布，计算尺度参数 \(\sigma = \sqrt{N}\)。
比较直方图与理论曲线的吻合度。
2. 位移平方分布分析方法
拟合卡方分布，验证自由度是否为 2。
通过对数坐标观察分布尾部特征。
## 实验结果
### 1. 位移分布
![Figure_1](https://github.com/user-attachments/assets/62d059ca-6d6a-4e09-8780-9091b3307e77)
- 观察到的分布特征：
  直方图呈现单峰右偏态，峰值位于 \(\sqrt{2N}\) 附近。
- 与理论预期的对比：
  拟合曲线（红色）与实验数据（蓝色）基本重合，验证了瑞利分布假设。
  尺度参数 \(\sigma\) 接近理论值 \(\sqrt{1000} \approx 31.62\)。
### 2. 位移平方分布
![Figure_2](https://github.com/user-attachments/assets/f72ab3c6-a9ea-4fd8-9530-91b6bf4a171c)
![Figure_3](https://github.com/user-attachments/assets/b5359bd0-bccb-43e4-8f48-0fd823ec82a0)
- 观察到的分布特征：
  线性坐标下，分布呈现指数衰减趋势。
  半对数坐标下，尾部近似直线，符合指数分布特性。
  对数坐标下，数据点分布偏离直线，说明非幂律关系。
- 与理论预期的对比：
  卡方拟合曲线（红色）与实验数据（蓝色）高度吻合，验证了 \(\chi^2_2\) 分布。
  自由度参数接近 2，均值接近理论值 \(2N = 2000\)。
## 讨论
1. 实验结果分析
   - 结果是否符合预期？
     位移分布符合瑞利模型，位移平方符合卡方分布，验证了理论预测。
   - 如果有偏差，可能的原因是什么？
     随机波动：1000 次模拟样本量有限，尾部数据存在统计噪声。
     步长离散性：理论模型假设连续步长，而实验中步长固定为 ±1。
2. 改进建议
   增加模拟次数：将 num_simulations 提高至 10,000 次，减少随机误差。
   扩展步数范围：测试不同 N 值（如 100, 10,000），验证尺度不变性。
   引入误差条：在直方图中添加置信区间，量化不确定性。
## 结论
主要发现：二维随机行走的位移模长服从瑞利分布，位移平方服从自由度为 2 的卡方分布，与理论预期一致。
物理意义：实验验证了中心极限定理在随机过程中的适用性，揭示了扩散现象的统计规律。
局限性：离散步长和有限样本量导致尾部拟合偏差，需通过增加模拟次数改进。
