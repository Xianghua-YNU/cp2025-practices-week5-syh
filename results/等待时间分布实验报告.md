# 等待时间分布实验报告模板
## 1. 实验概述
### 1.1 实验背景
在随机过程中，等待时间分布是一个重要的研究课题。本实验通过抛硬币模型，研究了稀有事件（硬币正面）出现之间的等待时间分布特性。当正面朝上概率较小（p=0.08）时，正面出现的过程可以看作是一个泊松过程，我们关注两次正面之间出现的反面次数的概率分布。

### 1.2 实验目的
- 理解稀有事件的等待时间分布特性
- 掌握随机序列的生成与分析方法
- 通过可视化和统计分析验证理论分布模型
## 2. 实验方法
### 2.1 实验原理
在抛硬币实验中，每次抛掷是独立的伯努利试验，正面概率为p=0.08。两次正面之间的等待时间（即中间出现的反面次数）理论上应该服从几何分布，其概率质量函数为：

P(X = k) = (1-p)^k * p

其中k是等待时间（反面次数）。几何分布的理论均值为(1-p)/p。

从连续时间角度看，等待时间也可以用指数分布描述，其理论均值为1/p。

### 2.2 实验步骤
1. 生成硬币序列（1表示正面，0表示反面）
2. 计算两次正面之间的等待时间
3. 绘制等待时间直方图（普通坐标和半对数坐标）
4. 分析等待时间的统计特性
5. 比较不同样本量下的结果
### 2.3 实验代码实现
简要描述代码实现的主要函数和方法：

- generate_coin_sequence : 生成硬币序列
- calculate_waiting_times : 计算等待时间
- plot_waiting_time_histogram : 绘制直方图
- analyze_waiting_time : 分析统计特性
## 3. 实验结果与分析
### 3.1 小样本实验（1000次抛掷） 
#### 3.1.1 等待时间分布直方图
![Figure_1](https://github.com/user-attachments/assets/6b7a902c-d572-45e5-b40c-baf338f33d0e)
#### 3.1.2 半对数坐标下的分布
![Figure_2](https://github.com/user-attachments/assets/7ff4dd47-53a3-40d4-a906-2c08643ee6f4)
 #### 3.1.3 统计分析
- 实验平均等待时间：[11.78]
- 理论平均等待时间（几何分布）：[11.50]
- 理论平均等待时间（指数分布）：[12.50]
- 标准差：[13.20]

#### 3.1.4 分布特性分析
几何分布和指数分布都具有无记忆性，在半对数坐标图中，如果等待时间符合几何分布或指数分布，其直方图应该近似呈现一条直线。这是因为几何分布的概率质量函数为 \(P(X = k)=(1 - p)^{k}p\)，两边取对数可得 \(\ln(P(X = k))=\ln(p)+k\ln(1 - p)\)，这是一个关于 k 的线性函数；指数分布的概率密度函数为 \(f(x)=\lambda e^{-\lambda x}\)，两边取对数可得 \(\ln(f(x))=\ln(\lambda)-\lambda x\)，同样是关于 x 的线性函数。所以，如果半对数坐标图中的点大致分布在一条直线上，那么等待时间很可能符合几何分布或指数分布的特性；若偏离直线程度较大，则说明可能不符合这些分布特性。

### 3.2 大样本实验（1000000次抛掷） 
#### 3.2.1 等待时间分布直方图
![Figure_3](https://github.com/user-attachments/assets/6261f4ae-7400-4152-9c45-5a88e3488b5b)
#### 3.2.2 半对数坐标下的分布
![Figure_4](https://github.com/user-attachments/assets/c0480559-86a1-4009-aa93-6478409a914d)
#### 3.2.3 统计分析
- 实验平均等待时间：[11.47]
- 理论平均等待时间（几何分布）：[11.50]
- 理论平均等待时间（指数分布）：[12.50]
- 标准差：[11.97]

#### 3.2.4 分布特性分析
实验平均等待时间与理论值比较：实验平均等待时间为 11.47，理论平均等待时间（几何分布）为 11.50，两者非常接近，说明在大样本下，实验结果与几何分布的理论均值高度拟合。而理论平均等待时间（指数分布）为 12.50，与实验值有一定差距，说明指数分布在描述该等待时间时拟合程度相对较差。
标准差与分布特性：标准差为 11.97，结合实验平均等待时间，在几何分布中，标准差 \(\sigma=\frac{\sqrt{1 - p}}{p}\)，对于 \(p = 0.08\)，理论标准差 \(\sigma=\frac{\sqrt{1 - 0.08}}{0.08}\approx11.92\)，实验标准差与理论值接近，进一步说明等待时间分布与几何分布拟合较好。
半对数坐标图分析：从半对数坐标图来看，如果图中数据点大致呈直线分布，那么说明等待时间分布符合几何分布的特性，因为几何分布在半对数坐标下是线性的。

### 3.3 样本量对结果的影响
比较小样本和大样本实验结果的差异：

- 分布形状的变化
小样本（1000 次抛掷）时，由于数据量较少，等待时间分布直方图可能会出现较多波动，形状不够平滑，难以准确体现出理论分布的特征。而大样本（1000000 次抛掷）时，分布直方图会更加平滑，更接近理论分布的形状。
- 实验均值与理论均值的接近程度
小样本实验中，实验均值可能会因为随机性而与理论均值有较大偏差。随着样本量的增大，根据大数定律，实验均值会逐渐趋近于理论均值。在本题中，大样本实验的平均等待时间（11.47）与几何分布的理论均值（11.50）非常接近，而小样本实验的均值可能会偏离理论值更多。
- 分布拟合的精确度
小样本情况下，由于数据的随机性和不稳定性，分布拟合的精确度较低，可能无法准确判断是否符合理论分布。大样本时，数据更能反映总体的真实情况，分布拟合的精确度更高，能更准确地判断等待时间是否符合几何分布或指数分布。
## 4. 讨论与结论
### 4.1 实验结果总结
总结等待时间分布的主要特性和规律。
等待时间分布在大样本下与几何分布拟合较好，实验平均等待时间接近几何分布的理论均值，标准差也与几何分布的理论标准差相近。
半对数坐标图的特征可以用于判断等待时间是否符合几何分布或指数分布，若呈直线则符合相应分布特性。
样本量越大，实验结果越接近理论分布，分布形状更平滑，实验均值与理论均值更接近，分布拟合的精确度更高。
### 4.2 理论解释
从概率论角度解释观察到的分布特性：
- 为什么等待时间符合几何分布/指数分布
在抛硬币实验中，每次抛硬币都是独立事件，正面出现的概率 p 保持不变。几何分布描述的是在一系列独立的伯努利试验中，首次成功所需的试验次数，这里的成功可以看作是硬币出现正面，所以两次正面之间的等待时间（反面次数）符合几何分布。指数分布是连续型随机变量的分布，当把抛硬币的时间间隔看作连续的，且事件（正面出现）的发生是一个泊松过程时，等待时间就符合指数分布。
- 半对数坐标下呈现直线的数学原理
如前面所述，几何分布的概率质量函数 \(P(X = k)=(1 - p)^{k}p\) 取对数后为 \(\ln(P(X = k))=\ln(p)+k\ln(1 - p)\)，指数分布的概率密度函数 \(f(x)=\lambda e^{-\lambda x}\) 取对数后为 \(\ln(f(x))=\ln(\lambda)-\lambda x\)，它们都是关于变量 k 或 x 的线性函数，所以在半对数坐标下呈现直线。
### 4.3 实验局限性
随机数生成的局限性：实验中使用的随机数生成器是伪随机数生成器，其生成的随机数并非真正的随机数，可能会存在一定的周期性和偏差，影响实验结果的准确性。
样本量的局限性：虽然 1000000 次抛掷已经是一个较大的样本量，但仍然不能完全代表总体情况。如果要更精确地验证理论分布，可能需要更大的样本量。
实验环境的理想化：实验假设每次抛硬币的过程是完全独立且正面出现的概率恒定为 0.08，但在实际情况中，可能会受到硬币本身的物理特性、抛硬币的方式等因素的影响，导致正面出现的概率发生变化。
### 4.4 结论
总结实验的主要发现和意义。
主要发现：通过实验发现，抛硬币两次正面之间的等待时间在大样本下符合几何分布的特性，实验结果与几何分布的理论值高度拟合。样本量对实验结果有显著影响，样本量越大，实验结果越接近理论分布。
意义：本实验验证了概率论中几何分布和指数分布的理论，展示了大数定律在实际实验中的应用。同时，也提醒我们在进行统计实验时，要注意样本量的选择和实验环境的控制，以提高实验结果的准确性。
